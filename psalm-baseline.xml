<?xml version="1.0" encoding="UTF-8"?>
<files psalm-version="5.26.1@d747f6500b38ac4f7dfc5edbcae6e4b637d7add0">
  <file src="config/oauth2.php">
    <MixedAssignment>
      <code><![CDATA[$config['encryption_key']]]></code>
    </MixedAssignment>
    <UnresolvableInclude>
      <code><![CDATA[require $encryptionKeyFile]]></code>
    </UnresolvableInclude>
  </file>
  <file src="src/AuthorizationHandler.php">
    <DeprecatedClass>
      <code><![CDATA[new CallableResponseFactoryDecorator(
                static fn(): ResponseInterface => $responseFactory()
            )]]></code>
    </DeprecatedClass>
    <MixedArgument>
      <code><![CDATA[$authRequest]]></code>
    </MixedArgument>
    <MixedAssignment>
      <code><![CDATA[$authRequest]]></code>
    </MixedAssignment>
  </file>
  <file src="src/AuthorizationHandlerFactory.php">
    <DeprecatedTrait>
      <code><![CDATA[Psr17ResponseFactoryTrait]]></code>
    </DeprecatedTrait>
    <MixedArgument>
      <code><![CDATA[$container->get(AuthorizationServer::class)]]></code>
    </MixedArgument>
    <PossiblyUnusedReturnValue>
      <code><![CDATA[AuthorizationHandler]]></code>
    </PossiblyUnusedReturnValue>
  </file>
  <file src="src/AuthorizationMiddleware.php">
    <DeprecatedClass>
      <code><![CDATA[new CallableResponseFactoryDecorator(
                static fn(): ResponseInterface => $responseFactory()
            )]]></code>
    </DeprecatedClass>
  </file>
  <file src="src/AuthorizationMiddlewareFactory.php">
    <DeprecatedTrait>
      <code><![CDATA[Psr17ResponseFactoryTrait]]></code>
    </DeprecatedTrait>
    <MixedArgument>
      <code><![CDATA[$container->get(AuthorizationServer::class)]]></code>
    </MixedArgument>
    <PossiblyUnusedReturnValue>
      <code><![CDATA[AuthorizationMiddleware]]></code>
    </PossiblyUnusedReturnValue>
  </file>
  <file src="src/AuthorizationServerFactory.php">
    <MixedArgument>
      <code><![CDATA[$container->get($grant)]]></code>
      <code><![CDATA[$event]]></code>
      <code><![CDATA[$grant]]></code>
      <code><![CDATA[$listener]]></code>
      <code><![CDATA[$priority]]></code>
      <code><![CDATA[$provider]]></code>
    </MixedArgument>
    <MixedArrayAccess>
      <code><![CDATA[$listenerConfig[0]]]></code>
      <code><![CDATA[$listenerConfig[1]]]></code>
      <code><![CDATA[$listenerConfig[2]]]></code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code><![CDATA[$event]]></code>
      <code><![CDATA[$grant]]></code>
      <code><![CDATA[$listener]]></code>
      <code><![CDATA[$listener]]></code>
      <code><![CDATA[$listenerConfig]]></code>
      <code><![CDATA[$provider]]></code>
      <code><![CDATA[$provider]]></code>
    </MixedAssignment>
  </file>
  <file src="src/ConfigProvider.php">
    <PossiblyUnusedReturnValue>
      <code><![CDATA[array]]></code>
    </PossiblyUnusedReturnValue>
  </file>
  <file src="src/ConfigTrait.php">
    <MixedInferredReturnType>
      <code><![CDATA[non-empty-string|non-empty-array]]></code>
      <code><![CDATA[string]]></code>
      <code><![CDATA[string]]></code>
      <code><![CDATA[string]]></code>
      <code><![CDATA[string]]></code>
    </MixedInferredReturnType>
  </file>
  <file src="src/CryptKeyTrait.php">
    <MixedArgument>
      <code><![CDATA[$keyConfig['key_or_path']]]></code>
      <code><![CDATA[$keyConfig['key_or_path']]]></code>
      <code><![CDATA[$passPhrase]]></code>
      <code><![CDATA[$passPhrase]]></code>
    </MixedArgument>
    <MixedAssignment>
      <code><![CDATA[$passPhrase]]></code>
    </MixedAssignment>
  </file>
  <file src="src/Entity/ClientEntity.php">
    <PropertyNotSetInConstructor>
      <code><![CDATA[$passwordClient]]></code>
      <code><![CDATA[$personalAccessClient]]></code>
      <code><![CDATA[$secret]]></code>
      <code><![CDATA[ClientEntity]]></code>
      <code><![CDATA[ClientEntity]]></code>
      <code><![CDATA[ClientEntity]]></code>
    </PropertyNotSetInConstructor>
  </file>
  <file src="src/Entity/RevokableTrait.php">
    <MissingConstructor>
      <code><![CDATA[$revoked]]></code>
      <code><![CDATA[$revoked]]></code>
      <code><![CDATA[$revoked]]></code>
      <code><![CDATA[$revoked]]></code>
    </MissingConstructor>
  </file>
  <file src="src/Entity/TimestampableTrait.php">
    <DocblockTypeContradiction>
      <code><![CDATA[! $this->createdAt]]></code>
      <code><![CDATA[$this->createdAt]]></code>
    </DocblockTypeContradiction>
    <MissingConstructor>
      <code><![CDATA[$createdAt]]></code>
      <code><![CDATA[$createdAt]]></code>
      <code><![CDATA[$updatedAt]]></code>
      <code><![CDATA[$updatedAt]]></code>
    </MissingConstructor>
    <MixedArgument>
      <code><![CDATA[$this->getTimezone()->getValue()]]></code>
    </MixedArgument>
    <MixedMethodCall>
      <code><![CDATA[getValue]]></code>
    </MixedMethodCall>
  </file>
  <file src="src/Grant/ClientCredentialsGrantFactory.php">
    <PossiblyUnusedParam>
      <code><![CDATA[$container]]></code>
    </PossiblyUnusedParam>
  </file>
  <file src="src/OAuth2Adapter.php">
    <DeprecatedClass>
      <code><![CDATA[new CallableResponseFactoryDecorator(
                static fn(): ResponseInterface => $responseFactory()
            )]]></code>
    </DeprecatedClass>
    <InvalidFunctionCall>
      <code><![CDATA[($this->userFactory)(
                    $userId,
                    [],
                    [
                        'oauth_user_id'         => $userId,
                        'oauth_client_id'       => $clientId,
                        'oauth_access_token_id' => $result->getAttribute('oauth_access_token_id', null),
                        'oauth_scopes'          => $result->getAttribute('oauth_scopes', null),
                    ]
                )]]></code>
    </InvalidFunctionCall>
    <InvalidMethodCall>
      <code><![CDATA[createResponse]]></code>
    </InvalidMethodCall>
    <InvalidPropertyAssignmentValue>
      <code><![CDATA[$responseFactory]]></code>
      <code><![CDATA[static fn(string $identity, array $roles = [], array $details = []): UserInterface
                => $userFactory($identity, $roles, $details)]]></code>
    </InvalidPropertyAssignmentValue>
    <MixedAssignment>
      <code><![CDATA[$clientId]]></code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code><![CDATA[?UserInterface]]></code>
      <code><![CDATA[ResponseInterface]]></code>
      <code><![CDATA[UserInterface]]></code>
    </MixedInferredReturnType>
    <MixedMethodCall>
      <code><![CDATA[withHeader]]></code>
    </MixedMethodCall>
    <MixedReturnStatement>
      <code><![CDATA[$this->responseFactory
            ->createResponse(401)
            ->withHeader(
                'WWW-Authenticate',
                'Bearer realm="OAuth2 token"'
            )]]></code>
      <code><![CDATA[$userFactory($identity, $roles, $details)]]></code>
      <code><![CDATA[($this->userFactory)(
                    $userId,
                    [],
                    [
                        'oauth_user_id'         => $userId,
                        'oauth_client_id'       => $clientId,
                        'oauth_access_token_id' => $result->getAttribute('oauth_access_token_id', null),
                        'oauth_scopes'          => $result->getAttribute('oauth_scopes', null),
                    ]
                )]]></code>
    </MixedReturnStatement>
  </file>
  <file src="src/OAuth2AdapterFactory.php">
    <DeprecatedTrait>
      <code><![CDATA[Psr17ResponseFactoryTrait]]></code>
    </DeprecatedTrait>
    <MixedArgument>
      <code><![CDATA[$container->get(UserInterface::class)]]></code>
      <code><![CDATA[$resourceServer]]></code>
    </MixedArgument>
    <MixedAssignment>
      <code><![CDATA[$resourceServer]]></code>
    </MixedAssignment>
  </file>
  <file src="src/Psr17ResponseFactoryTrait.php">
    <DeprecatedClass>
      <code><![CDATA[new CallableResponseFactoryDecorator($responseFactory)]]></code>
    </DeprecatedClass>
    <InternalClass>
      <code><![CDATA[new CallableResponseFactoryDecorator($responseFactory)]]></code>
    </InternalClass>
    <UndefinedClass>
      <code><![CDATA[ResponseFactoryFactory]]></code>
    </UndefinedClass>
  </file>
  <file src="src/Repository/Pdo/AbstractRepository.php">
    <MixedMethodCall>
      <code><![CDATA[getIdentifier]]></code>
    </MixedMethodCall>
    <MixedOperand>
      <code><![CDATA[$item->getIdentifier()]]></code>
      <code><![CDATA[$result]]></code>
    </MixedOperand>
    <PropertyTypeCoercion>
      <code><![CDATA[$pdo]]></code>
    </PropertyTypeCoercion>
  </file>
  <file src="src/Repository/Pdo/AccessTokenRepository.php">
    <MissingReturnType>
      <code><![CDATA[persistNewAccessToken]]></code>
      <code><![CDATA[revokeAccessToken]]></code>
    </MissingReturnType>
    <MixedArgument>
      <code><![CDATA[$userIdentifier]]></code>
    </MixedArgument>
  </file>
  <file src="src/Repository/Pdo/AccessTokenRepositoryFactory.php">
    <MixedArgument>
      <code><![CDATA[$container->get(PdoService::class)]]></code>
    </MixedArgument>
  </file>
  <file src="src/Repository/Pdo/AuthCodeRepository.php">
    <MissingReturnType>
      <code><![CDATA[persistNewAuthCode]]></code>
      <code><![CDATA[revokeAuthCode]]></code>
    </MissingReturnType>
    <MixedArrayAccess>
      <code><![CDATA[$row['revoked']]]></code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code><![CDATA[$row]]></code>
    </MixedAssignment>
  </file>
  <file src="src/Repository/Pdo/AuthCodeRepositoryFactory.php">
    <MixedArgument>
      <code><![CDATA[$container->get(PdoService::class)]]></code>
    </MixedArgument>
  </file>
  <file src="src/Repository/Pdo/ClientRepository.php">
    <MixedArgument>
      <code><![CDATA[$clientData['name'] ?? '']]></code>
      <code><![CDATA[$clientData['redirect'] ?? '']]></code>
      <code><![CDATA[$clientData['secret']]]></code>
    </MixedArgument>
    <MixedAssignment>
      <code><![CDATA[$row]]></code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code><![CDATA[?array]]></code>
    </MixedInferredReturnType>
    <MixedReturnStatement>
      <code><![CDATA[$row]]></code>
    </MixedReturnStatement>
  </file>
  <file src="src/Repository/Pdo/ClientRepositoryFactory.php">
    <MixedArgument>
      <code><![CDATA[$container->get(PdoService::class)]]></code>
    </MixedArgument>
  </file>
  <file src="src/Repository/Pdo/PdoServiceFactory.php">
    <MixedArgument>
      <code><![CDATA[$config['dsn']]]></code>
      <code><![CDATA[$password]]></code>
      <code><![CDATA[$username]]></code>
    </MixedArgument>
    <MixedArrayAccess>
      <code><![CDATA[$config['authentication']]]></code>
      <code><![CDATA[$config['authentication']['pdo']]]></code>
      <code><![CDATA[$config['dsn']]]></code>
      <code><![CDATA[$config['password']]]></code>
      <code><![CDATA[$config['username']]]></code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code><![CDATA[$config]]></code>
      <code><![CDATA[$config]]></code>
      <code><![CDATA[$password]]></code>
      <code><![CDATA[$username]]></code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code><![CDATA[PDO]]></code>
    </MixedInferredReturnType>
    <MixedReturnStatement>
      <code><![CDATA[$container->get($config)]]></code>
    </MixedReturnStatement>
  </file>
  <file src="src/Repository/Pdo/RefreshTokenRepository.php">
    <MissingReturnType>
      <code><![CDATA[persistNewRefreshToken]]></code>
      <code><![CDATA[revokeRefreshToken]]></code>
    </MissingReturnType>
    <MixedArrayAccess>
      <code><![CDATA[$row['revoked']]]></code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code><![CDATA[$row]]></code>
    </MixedAssignment>
  </file>
  <file src="src/Repository/Pdo/RefreshTokenRepositoryFactory.php">
    <MixedArgument>
      <code><![CDATA[$container->get(PdoService::class)]]></code>
    </MixedArgument>
  </file>
  <file src="src/Repository/Pdo/ScopeRepository.php">
    <MixedArrayAccess>
      <code><![CDATA[$row['id']]]></code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code><![CDATA[$row]]></code>
    </MixedAssignment>
  </file>
  <file src="src/Repository/Pdo/ScopeRepositoryFactory.php">
    <MixedArgument>
      <code><![CDATA[$container->get(PdoService::class)]]></code>
    </MixedArgument>
  </file>
  <file src="src/Repository/Pdo/UserRepository.php">
    <MixedArgument>
      <code><![CDATA[$row['password']]]></code>
      <code><![CDATA[$username]]></code>
    </MixedArgument>
    <MixedArrayAccess>
      <code><![CDATA[$row['password']]]></code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code><![CDATA[$row]]></code>
    </MixedAssignment>
  </file>
  <file src="src/Repository/Pdo/UserRepositoryFactory.php">
    <MixedArgument>
      <code><![CDATA[$container->get(PdoService::class)]]></code>
    </MixedArgument>
  </file>
  <file src="src/RepositoryTrait.php">
    <MixedInferredReturnType>
      <code><![CDATA[AccessTokenRepositoryInterface]]></code>
      <code><![CDATA[AuthCodeRepositoryInterface]]></code>
      <code><![CDATA[ClientRepositoryInterface]]></code>
      <code><![CDATA[RefreshTokenRepositoryInterface]]></code>
      <code><![CDATA[ScopeRepositoryInterface]]></code>
      <code><![CDATA[UserRepositoryInterface]]></code>
    </MixedInferredReturnType>
  </file>
  <file src="src/ResourceServerFactory.php">
    <MixedArgument>
      <code><![CDATA[$config['public_key']]]></code>
    </MixedArgument>
    <MixedArrayAccess>
      <code><![CDATA[$config['authentication']]]></code>
    </MixedArrayAccess>
    <MixedAssignment>
      <code><![CDATA[$config]]></code>
    </MixedAssignment>
  </file>
  <file src="src/TokenEndpointHandler.php">
    <DeprecatedClass>
      <code><![CDATA[new CallableResponseFactoryDecorator(
                static fn(): ResponseInterface => $responseFactory()
            )]]></code>
    </DeprecatedClass>
  </file>
  <file src="src/TokenEndpointHandlerFactory.php">
    <DeprecatedTrait>
      <code><![CDATA[Psr17ResponseFactoryTrait]]></code>
    </DeprecatedTrait>
    <MixedArgument>
      <code><![CDATA[$container->get(AuthorizationServer::class)]]></code>
    </MixedArgument>
  </file>
  <file src="test/AuthorizationServerFactoryTest.php">
    <UnusedClosureParam>
      <code><![CDATA[$event]]></code>
    </UnusedClosureParam>
  </file>
  <file src="test/ConfigTraitTest.php">
    <MixedAssignment>
      <code><![CDATA[$result]]></code>
      <code><![CDATA[$result]]></code>
      <code><![CDATA[$result]]></code>
      <code><![CDATA[$result]]></code>
      <code><![CDATA[$result]]></code>
      <code><![CDATA[$result]]></code>
      <code><![CDATA[$result]]></code>
      <code><![CDATA[$result]]></code>
      <code><![CDATA[$result]]></code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code><![CDATA[array|string]]></code>
    </MixedInferredReturnType>
    <MixedMethodCall>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
    </MixedMethodCall>
    <MixedReturnStatement>
      <code><![CDATA[$this->$name($container)]]></code>
    </MixedReturnStatement>
  </file>
  <file src="test/Entity/UserEntityTest.php">
    <TooFewArguments>
      <code><![CDATA[new UserEntity()]]></code>
    </TooFewArguments>
    <UnusedVariable>
      <code><![CDATA[$entity]]></code>
    </UnusedVariable>
  </file>
  <file src="test/OAuth2AdapterTest.php">
    <MixedArgumentTypeCoercion>
      <code><![CDATA[$details]]></code>
      <code><![CDATA[$roles]]></code>
    </MixedArgumentTypeCoercion>
  </file>
  <file src="test/Pdo/OAuth2PdoMiddlewareTest.php">
    <ArgumentTypeCoercion>
      <code><![CDATA[$consumerHandler]]></code>
      <code><![CDATA[$consumerHandler]]></code>
    </ArgumentTypeCoercion>
    <MixedArgument>
      <code><![CDATA[$data['token_type']]]></code>
    </MixedArgument>
    <MixedArgumentTypeCoercion>
      <code><![CDATA[$this->responseFactory]]></code>
      <code><![CDATA[$this->responseFactory]]></code>
      <code><![CDATA[$this->responseFactory]]></code>
      <code><![CDATA[$this->responseFactory]]></code>
      <code><![CDATA[$this->responseFactory]]></code>
      <code><![CDATA[$this->responseFactory]]></code>
      <code><![CDATA[$this->responseFactory]]></code>
      <code><![CDATA[$this->responseFactory]]></code>
      <code><![CDATA[$this->responseFactory]]></code>
    </MixedArgumentTypeCoercion>
    <MixedAssignment>
      <code><![CDATA[$content]]></code>
      <code><![CDATA[$content]]></code>
      <code><![CDATA[$content]]></code>
      <code><![CDATA[$content]]></code>
    </MixedAssignment>
    <MixedInferredReturnType>
      <code><![CDATA[string]]></code>
      <code><![CDATA[string]]></code>
    </MixedInferredReturnType>
    <MixedPropertyFetch>
      <code><![CDATA[$content->access_token]]></code>
      <code><![CDATA[$content->access_token]]></code>
      <code><![CDATA[$content->access_token]]></code>
      <code><![CDATA[$content->access_token]]></code>
      <code><![CDATA[$content->expires_in]]></code>
      <code><![CDATA[$content->expires_in]]></code>
      <code><![CDATA[$content->expires_in]]></code>
      <code><![CDATA[$content->expires_in]]></code>
      <code><![CDATA[$content->refresh_token]]></code>
      <code><![CDATA[$content->refresh_token]]></code>
      <code><![CDATA[$content->refresh_token]]></code>
      <code><![CDATA[$content->token_type]]></code>
      <code><![CDATA[$content->token_type]]></code>
      <code><![CDATA[$content->token_type]]></code>
      <code><![CDATA[$content->token_type]]></code>
    </MixedPropertyFetch>
    <MixedReturnStatement>
      <code><![CDATA[$content->refresh_token]]></code>
      <code><![CDATA[$data['code']]]></code>
    </MixedReturnStatement>
  </file>
  <file src="test/Psr17ResponseFactoryTraitTest.php">
    <DeprecatedClass>
      <code><![CDATA[CallableResponseFactoryDecorator::class]]></code>
    </DeprecatedClass>
    <InternalMethod>
      <code><![CDATA[getResponseFromCallable]]></code>
    </InternalMethod>
    <UndefinedClass>
      <code><![CDATA[ResponseFactoryFactory]]></code>
    </UndefinedClass>
  </file>
  <file src="test/RepositoryTraitTest.php">
    <MixedInferredReturnType>
      <code><![CDATA[RepositoryInterface]]></code>
    </MixedInferredReturnType>
    <MixedMethodCall>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
      <code><![CDATA[proxy]]></code>
    </MixedMethodCall>
    <MixedReturnStatement>
      <code><![CDATA[$this->$name($container)]]></code>
    </MixedReturnStatement>
  </file>
  <file src="test/TestAsset/Psr17ResponseFactoryTraitImplementation.php">
    <DeprecatedTrait>
      <code><![CDATA[Psr17ResponseFactoryTrait]]></code>
    </DeprecatedTrait>
  </file>
</files>
